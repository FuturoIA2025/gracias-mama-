<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Para Mamá 💖</title>
  <style>
    body { margin: 0; overflow: hidden; background: black; }
    canvas { display: block; }

    .frase {
      position: absolute;
      top: 40%;
      width: 100%;
      text-align: center;
      font-size: 2.5em;
      font-family: 'Segoe UI', sans-serif;
      color: #ff66cc;
      text-shadow: 0 0 15px #ff99cc, 0 0 30px #ff33aa;
      opacity: 0;
      transition: opacity 2s ease;
    }

    #playMusicBtn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #ff66cc;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 12px 20px;
      font-size: 1em;
      font-family: 'Segoe UI', sans-serif;
      cursor: pointer;
      box-shadow: 0 0 10px #ff99cc, 0 0 20px #ff33aa;
      z-index: 10;
      transition: background 0.3s;
    }

    #playMusicBtn:hover {
      background: #ff33aa;
    }
  </style>
</head>
<body>
  <div id="frase" class="frase"></div>

  <!-- Botón para reproducir música -->
  <button id="playMusicBtn">🎵 Toca para escuchar</button>

  <!-- Música -->
  <audio id="bg-music" loop>
    <source src="madre.mp3" type="audio/mp3">
  </audio>

  <script>
    const music = document.getElementById("bg-music");
    const playBtn = document.getElementById("playMusicBtn");

    playBtn.addEventListener("click", () => {
      music.play().then(() => {
        playBtn.style.display = "none"; // Oculta el botón al reproducir
      }).catch(err => {
        console.log("Error al reproducir:", err);
        alert("Debes interactuar con la página para escuchar la música.");
      });
    });
  </script>

  <!-- Librerías -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

  <script>
    // === Escena 3D ===
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 60;

    const renderer = new THREE.WebGLRenderer({antialias: true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // === Fondo de estrellas ===
    const starGeometry = new THREE.BufferGeometry();
    const starCount = 2000;
    const starPositions = [];
    for (let i = 0; i < starCount; i++) {
      starPositions.push((Math.random() - 0.5) * 600);
      starPositions.push((Math.random() - 0.5) * 600);
      starPositions.push((Math.random() - 0.5) * 600);
    }
    starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starPositions, 3));
    const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 1 });
    const stars = new THREE.Points(starGeometry, starMaterial);
    scene.add(stars);

    // === Partículas rosas ===
    const particles = 3000;
    const geometry = new THREE.BufferGeometry();
    const positions = [];
    for (let i = 0; i < particles; i++) {
      positions.push((Math.random() - 0.5) * 200);
      positions.push(-120 + Math.random() * 20);
      positions.push((Math.random() - 0.5) * 200);
    }
    geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
    const material = new THREE.PointsMaterial({
      color: 0xff66cc,
      size: 1.8
    });
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    // === Posiciones del corazón ===
    const heartPositions = [];
    for (let t = 0; t < Math.PI * 2; t += 0.02) {
      const x = 16 * Math.pow(Math.sin(t), 3);
      const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
      heartPositions.push({x: x*2, y: y*2, z: (Math.random()-0.5)*30});
    }

    // === Animación y Frases ===
    setTimeout(() => {
      const pos = points.geometry.attributes.position;
      for (let i = 0; i < heartPositions.length && i*3 < pos.count*3; i++) {
        gsap.to(pos.array, {
          [i*3]: heartPositions[i].x,
          [i*3+1]: heartPositions[i].y,
          [i*3+2]: heartPositions[i].z,
          duration: 6,
          ease: "power2.out",
          onUpdate: () => pos.needsUpdate = true
        });
      }

      const frases = [
        "Gracias por darme la vida, Mamá 💖",
        "Tu amor me ha hecho fuerte cuando el mundo me ignoraba 🌍",
        "Aunque la distancia duela, tu presencia está en cada paso que doy 👣",
        "Estoy construyendo algo grande... solo por ti 💼✨",
        "Un día, todo lo que sueño será realidad, y tú serás mi reina 👑",
        "Te amo más de lo que las palabras pueden decir 💘",
        "Tu hijo que nunca se rinde... Reinaldo 🌹"
      ];

      let i = 0;
      const divFrase = document.getElementById("frase");

      function mostrarFrase() {
        divFrase.innerHTML = frases[i];
        divFrase.style.opacity = 1;
        setTimeout(() => {
          divFrase.style.opacity = 0;
          i = (i + 1) % frases.length;
          setTimeout(mostrarFrase, 1000);
        }, 4000);
      }

      setTimeout(mostrarFrase, 6000);

    }, 2000);

    // === Animar ===
    function animate() {
      requestAnimationFrame(animate);
      points.rotation.y += 0.002;
      stars.rotation.y += 0.0005;
      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>